# Funckeeper
- ğŸš§ è­¦å‘Šï¼šè¿™æ˜¯ä¸€ä¸ªè‡ªç”¨å¼€æºçš„é¡¹ç›®ï¼
- ğŸ“ è®°å½•å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹å’Œç»“æœ
- ğŸ” è¿½è¸ªå‡½æ•°æ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯ï¼ˆå‚æ•°ã€è¿”å›å€¼ã€æ‰§è¡Œæ—¶é—´ç­‰ï¼‰
- ğŸ“Š ç»Ÿè®¡åˆ†æå‡½æ•°çš„æ‰§è¡Œæƒ…å†µ
- ğŸ› æ•è·å’Œåˆ†æå‡½æ•°æ‰§è¡Œä¸­çš„é”™è¯¯
- ğŸ“¤ æ”¯æŒå¯¼å‡ºåˆ†ææŠ¥å‘Šï¼ˆHTMLæ ¼å¼ï¼‰

## ç›®çš„

`funckeeper` æ˜¯ä¸€ä¸ªä¸“æ³¨äº Python å‡½æ•°æ‰§è¡Œè®°å½•å’Œè¿½è¸ªçš„å·¥å…·ï¼Œä¸»è¦ç”¨äºè§£å†³ä»¥ä¸‹åœºæ™¯ï¼š

1. **æºç è¿½æº¯**ï¼šå½“è„šæœ¬æ–‡ä»¶è¢«åˆ é™¤æˆ–ä¿®æ”¹åï¼Œå¯ä»¥é€šè¿‡ funckeeper æŸ¥çœ‹å†å²æ‰§è¡Œè®°å½•ä¸­ä¿å­˜çš„æºä»£ç ï¼Œå¸®åŠ©æ¢å¤æˆ–é‡å»ºè„šæœ¬ã€‚

2. **åŠŸèƒ½å›æº¯**ï¼šé€šè¿‡è®°å½•çš„å‡½æ•°æ–‡æ¡£è¯´æ˜ã€æ‰§è¡Œå‚æ•°å’Œç»“æœï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå›å¿†å’Œç†è§£ä¹‹å‰ç¼–å†™çš„è„šæœ¬åŠŸèƒ½ã€‚

3. **æ‰§è¡Œåˆ†æ**ï¼š
   - è®°å½•å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€å‚æ•°ã€è¿”å›å€¼ç­‰è¯¦ç»†ä¿¡æ¯
   - ç»Ÿè®¡å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ã€æˆåŠŸç‡ã€å¹³å‡æ‰§è¡Œæ—¶é—´ç­‰
   - åˆ†æå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ç±»å‹å’Œé¢‘ç‡

4. **æŠ¥å‘Šç”Ÿæˆ**ï¼šæ”¯æŒå°†æ‰§è¡Œè®°å½•ã€ç»Ÿè®¡ä¿¡æ¯å¯¼å‡ºä¸ºHTMLæ ¼å¼çš„æŠ¥å‘Šï¼Œä¾¿äºåˆ†äº«å’Œå½’æ¡£ã€‚

æ‰€æœ‰æ‰§è¡Œä¿¡æ¯éƒ½ä¼šè¢«å­˜å‚¨åœ¨ SQLite æ•°æ®åº“ä¸­ï¼Œæ–¹ä¾¿åç»­æŸ¥è¯¢å’Œåˆ†æã€‚é€šè¿‡è¿™äº›æ•°æ®ï¼Œå¼€å‘è€…å¯ä»¥ï¼š
- è¿½æº¯å†å²æ‰§è¡Œçš„è„šæœ¬å†…å®¹å’ŒåŠŸèƒ½
- åˆ†æå‡½æ•°æ‰§è¡Œæ•ˆç‡å’Œç¨³å®šæ€§
- å¿«é€Ÿå®šä½å’Œè§£å†³å¸¸è§é”™è¯¯
- ç”Ÿæˆè¯¦ç»†çš„æ‰§è¡ŒæŠ¥å‘Š
- é‡ç°å‡½æ•°æ‰§è¡Œç¯å¢ƒ
- è¿½è¸ªå†å²è„šæœ¬çš„ä¾èµ–éœ€æ±‚
- ç¡®ä¿ä»£ç è¿ç§»æ—¶çš„ä¾èµ–å®Œæ•´æ€§

## ä½¿ç”¨æ‰‹å†Œ

### å®‰è£…

ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Python 3.6 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… `funckeeper`ï¼š

```bash
pip install funckeeper
```

### åŸºæœ¬ç”¨æ³•

1. **åˆå§‹åŒ– `FuncKeeper` å®ä¾‹**

   ```python
   from funckeeper import FuncKeeper

   keeper = FuncKeeper()
   ```

2. **è£…é¥°å‡½æ•°**

   ä½¿ç”¨ `FuncKeeper` å®ä¾‹ä½œä¸ºè£…é¥°å™¨æ¥è£…é¥°ä½ æƒ³è¦è®°å½•çš„å‡½æ•°ï¼š

   ```python
   @keeper(tags=["example", "demo"])
   def my_function(x, y):
       """è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°"""
       return x + y
   ```

3. **æ‰§è¡Œå‡½æ•°**

   è°ƒç”¨è¢«è£…é¥°çš„å‡½æ•°ï¼Œ`funckeeper` ä¼šè‡ªåŠ¨è®°å½•æ‰§è¡Œä¿¡æ¯ï¼š

   ```python
   result = my_function(3, 4)
   ```

4. **å¯¼å‡ºæ•°æ®**

   ä½ å¯ä»¥å¯¼å‡ºå‡½æ•°çš„æ‰§è¡Œè¯¦æƒ…ã€ç»Ÿè®¡ä¿¡æ¯æˆ–æ‰§è¡Œåˆ—è¡¨ï¼š

   ```python
   keeper.export_data(data, export_type='detail', output_dir='exports')
   ```

## ç¤ºä¾‹

### ç¤ºä¾‹ 1: è®°å½•å‡½æ•°æ‰§è¡Œ

```python
@keeper(tags=["math", "addition"])
def add(a, b):
    """è¿”å›ä¸¤ä¸ªæ•°çš„å’Œ"""
    return a + b

add(5, 7)
```

**æ‰§è¡Œç»“æœ:**

- å‡½æ•°å: `add`
- æ‰§è¡Œæ—¶é—´: `2024-11-27 18:13:47`
- è€—æ—¶: `0.0001s`
- è¿”å›å€¼: `12`
- æ ‡ç­¾: `math, addition`

### ç¤ºä¾‹ 2: å¯¼å‡ºæ‰§è¡Œè¯¦æƒ…

```python
data = keeper.get_record_detail(1)
keeper.export_data(data, export_type='detail', output_dir='exports')
```

**ç”Ÿæˆçš„HTMLæ–‡ä»¶:**

- æ–‡ä»¶å: `funckeeper_detail_20241127_181347.html`
- åŒ…å«å‡½æ•°çš„æ‰§è¡Œè¯¦æƒ…ï¼ŒåŒ…æ‹¬å‚æ•°ã€è¿”å›å€¼ã€æ‰§è¡Œæ—¶é—´ç­‰ã€‚

### é«˜çº§ç”¨æ³•ç¤ºä¾‹

### ç¤ºä¾‹ 3: è·å–å‡½æ•°ç»Ÿè®¡ä¿¡æ¯

```python
from funckeeper import FuncKeeper
from datetime import datetime

keeper = FuncKeeper('test.db')

# è·å–æ‰€æœ‰å‡½æ•°çš„ç»Ÿè®¡ä¿¡æ¯
stats = keeper.get_statistics()

# è·å–ç‰¹å®šæ—¶é—´èŒƒå›´å†…çš„ç»Ÿè®¡ä¿¡æ¯
start_date = datetime(2024, 1, 1)
end_date = datetime(2024, 12, 31)
stats = keeper.get_statistics(
    func_name="my_func",
    start_date=start_date,
    end_date=end_date,
    status="success"
)

# æ‰“å°ç»Ÿè®¡ä¿¡æ¯
keeper.print_statistics(stats)
```

**æ‰§è¡Œç»“æœ:**
```
=== å‡½æ•°ç»Ÿè®¡: my_func ===
æ€»è°ƒç”¨æ¬¡æ•°: 9
æˆåŠŸæ¬¡æ•°: 9
å¤±è´¥æ¬¡æ•°: 0
æˆåŠŸç‡: 100.00%
å¹³å‡æ‰§è¡Œæ—¶é—´: 0.0111s
æœ€çŸ­æ‰§è¡Œæ—¶é—´: 0.0035s
æœ€é•¿æ‰§è¡Œæ—¶é—´: 0.0241s
é¦–æ¬¡è°ƒç”¨: 2024-11-28 02:18:26
æœ€åè°ƒç”¨: 2024-11-28 02:28:40
```

### ç¤ºä¾‹ 4: æœç´¢æ‰§è¡Œè®°å½•

```python
# æŒ‰å…³é”®å­—å’Œæ ‡ç­¾æœç´¢
results = keeper.search(
    keyword="calculate",
    tags=["math", "important"],
    status="error",
    start_date=datetime(2024, 1, 1),
    end_date=datetime(2024, 12, 31)
)
```

**æ‰§è¡Œç»“æœ:**
```
æ‰¾åˆ° 1 æ¡è®°å½•:

--- è®°å½• 1 ---
è®°å½•ID: 11
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: é™¤æ³•å‡½æ•°ï¼Œè®¡ç®— a é™¤ä»¥ b çš„ç»“æœ
æ‰§è¡Œæ—¶é—´: 2024-11-28 02:28:40
è€—æ—¶: 0.0073s
è°ƒç”¨å‚æ•°: 1, 0
é”™è¯¯ä¿¡æ¯: division by zero
```

## ä¸»è¦å‡½æ•°å‚æ•°è¯´æ˜

### FuncKeeper ç±»

#### `get_statistics(func_name: str = None, start_date: datetime = None, end_date: datetime = None, status: str = None)`
- `func_name`: è¦ç»Ÿè®¡çš„å‡½æ•°åç§°ï¼ˆå¯é€‰ï¼‰
- `start_date`: ç»Ÿè®¡å¼€å§‹æ—¶é—´ï¼ˆå¯é€‰ï¼‰
- `end_date`: ç»Ÿè®¡ç»“æŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
- `status`: æ‰§è¡ŒçŠ¶æ€ç­›é€‰ï¼Œå¯é€‰å€¼ï¼š"success"æˆ–"error"

#### `search(keyword: str = None, tags: List[str] = None, status: str = None, start_date: datetime = None, end_date: datetime = None)`
- `keyword`: æœç´¢å…³é”®å­—ï¼Œä¼šåŒ¹é…å‡½æ•°åã€æºä»£ç ã€æ–‡æ¡£å’Œé”™è¯¯ä¿¡æ¯
- `tags`: æ ‡ç­¾åˆ—è¡¨ï¼Œç”¨äºç­›é€‰ç‰¹å®šæ ‡ç­¾çš„è®°å½•
- `status`: æ‰§è¡ŒçŠ¶æ€ç­›é€‰
- `start_date`: æœç´¢å¼€å§‹æ—¶é—´
- `end_date`: æœç´¢ç»“æŸæ—¶é—´

#### `export_data(data: Any, export_type: str, output_dir: str = "exports")`
- `data`: è¦å¯¼å‡ºçš„æ•°æ®
- `export_type`: å¯¼å‡ºç±»å‹ï¼Œå¯é€‰å€¼ï¼š
  - "detail": å¯¼å‡ºè¯¦ç»†æ‰§è¡Œè®°å½•
  - "statistics": å¯¼å‡ºç»Ÿè®¡ä¿¡æ¯
  - "list": å¯¼å‡ºæ‰§è¡Œè®°å½•åˆ—è¡¨
- `output_dir`: å¯¼å‡ºæ–‡ä»¶ä¿å­˜ç›®å½•ï¼Œé»˜è®¤ä¸º"exports"

### ç¤ºä¾‹ 5: å®Œæ•´çš„é”™è¯¯å¤„ç†ç¤ºä¾‹

```python
from funckeeper import FuncKeeper

keeper = FuncKeeper()

@keeper(tags=["math", "division"])
def divide(a, b):
    """å®‰å…¨é™¤æ³•å‡½æ•°"""
    try:
        return a / b
    except ZeroDivisionError as e:
        raise ValueError("é™¤æ•°ä¸èƒ½ä¸ºé›¶") from e

# æµ‹è¯•æ­£å¸¸æƒ…å†µ
result = divide(10, 2)  # è¿”å› 5.0

# æµ‹è¯•é”™è¯¯æƒ…å†µ
try:
    result = divide(10, 0)
except ValueError as e:
    print(f"æ•è·åˆ°é”™è¯¯: {e}")

# è·å–å‡½æ•°ç»Ÿè®¡ä¿¡æ¯
stats = keeper.get_statistics(func_name="divide")
keeper.print_statistics(stats)
```

**æ‰§è¡Œç»“æœ:**
```
æ•è·åˆ°é”™è¯¯: é™¤æ•°ä¸èƒ½ä¸ºé›¶

=== å‡½æ•°ç»Ÿè®¡: divide ===
æ€»è°ƒç”¨æ¬¡æ•°: 12
æˆåŠŸæ¬¡æ•°: 10
å¤±è´¥æ¬¡æ•°: 2
æˆåŠŸç‡: 83.33%
å¹³å‡æ‰§è¡Œæ—¶é—´: 0.0106s
æœ€çŸ­æ‰§è¡Œæ—¶é—´: 0.0035s
æœ€é•¿æ‰§è¡Œæ—¶é—´: 0.0241s
é¦–æ¬¡è°ƒç”¨: 2024-11-28 02:18:26
æœ€åè°ƒç”¨: 2024-11-28 03:27:28

é”™è¯¯ç±»å‹åˆ†å¸ƒ:
- ValueError: 1æ¬¡
- ZeroDivisionError: 1æ¬¡
```
### ç¤ºä¾‹ 6: å¯¼å‡ºæœç´¢ç»“æœ

```python
    keeper = FuncKeeper(r"D:\1fkl\test.db")

    # è·å–æ‰€æœ‰å‡½æ•°çš„ç»Ÿè®¡ä¿¡æ¯
    @keeper(tags=["math", "division"])
    def divide(a, b):
        """å®‰å…¨é™¤æ³•å‡½æ•°"""
        try:
            return a / b
        except ZeroDivisionError as e:
            raise ValueError("é™¤æ•°ä¸èƒ½ä¸ºé›¶") from e

    # æµ‹è¯•æ­£å¸¸æƒ…å†µ
    result = divide(10, 2)  # è¿”å› 5.0

    # æµ‹è¯•é”™è¯¯æƒ…å†µ
    try:
        result = divide(10, 0)
    except ValueError as e:
        print(f"æ•è·åˆ°é”™è¯¯: {e}")

    # è·å–å‡½æ•°ç»Ÿè®¡ä¿¡æ¯
    stats = keeper.get_statistics(func_name="divide")
    keeper.print_statistics(stats)
    # å¯¼å‡ºæœç´¢ç»“æœåˆ—è¡¨
    results = keeper.search(keyword="é™¤æ³•")
    if results:
        filepath = keeper.export_data(results, "list", r"D:\1fkl\exports")
        print(f"\næœç´¢ç»“æœå·²å¯¼å‡ºåˆ°: {filepath}")

    # # å¯¼å‡ºè¯¦ç»†ä¿¡æ¯
    if results:
        detail = keeper.get_record_detail(results[0]["id"])
        if detail:  # ç¡®ä¿æœ‰è¿”å›å€¼
            filepath = keeper.export_data(detail, "detail", "exports")
            print(f"\nè¯¦ç»†ä¿¡æ¯å·²å¯¼å‡ºåˆ°: {filepath}")

    # # å¯¼å‡ºç»Ÿè®¡ä¿¡æ¯
    stats = keeper.get_statistics()
    filepath = keeper.export_data(stats, "statistics", "exports")
    print(f"\nç»Ÿè®¡ä¿¡æ¯å·²å¯¼å‡ºåˆ°: {filepath}")
```
```
--- è®°å½• 1 ---
è®°å½•ID: 6
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: å®‰å…¨é™¤æ³•å‡½æ•°
æ‰§è¡Œæ—¶é—´: 2024-11-28 06:03:24
è€—æ—¶: 0.0084s
è°ƒç”¨å‚æ•°: 10, 0
é”™è¯¯ä¿¡æ¯: é™¤æ•°ä¸èƒ½ä¸ºé›¶

--- è®°å½• 2 ---
è®°å½•ID: 5
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: å®‰å…¨é™¤æ³•å‡½æ•°
æ‰§è¡Œæ—¶é—´: 2024-11-28 06:03:23
è€—æ—¶: 0.0128s
è°ƒç”¨å‚æ•°: 10, 2
è¿”å›å€¼: 5.0

--- è®°å½• 3 ---
è®°å½•ID: 3
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: å®‰å…¨é™¤æ³•å‡½æ•°
æ‰§è¡Œæ—¶é—´: 2024-11-28 06:03:04
è€—æ—¶: 0.0000s
è°ƒç”¨å‚æ•°: 10, 2
è¿”å›å€¼: 5.0

--- è®°å½• 4 ---
è®°å½•ID: 4
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: å®‰å…¨é™¤æ³•å‡½æ•°
æ‰§è¡Œæ—¶é—´: 2024-11-28 06:03:04
è€—æ—¶: 0.0095s
è°ƒç”¨å‚æ•°: 10, 0
é”™è¯¯ä¿¡æ¯: é™¤æ•°ä¸èƒ½ä¸ºé›¶

--- è®°å½• 5 ---
è®°å½•ID: 1
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: å®‰å…¨é™¤æ³•å‡½æ•°
æ‰§è¡Œæ—¶é—´: 2024-11-28 06:02:16
è€—æ—¶: 0.0114s
è°ƒç”¨å‚æ•°: 10, 2
è¿”å›å€¼: 5.0

--- è®°å½• 6 ---
è®°å½•ID: 2
å‡½æ•°å: divide
æ–‡æ¡£è¯´æ˜: å®‰å…¨é™¤æ³•å‡½æ•°
æ‰§è¡Œæ—¶é—´: 2024-11-28 06:02:16
è€—æ—¶: 0.0000s
è°ƒç”¨å‚æ•°: 10, 0
é”™è¯¯ä¿¡æ¯: é™¤æ•°ä¸èƒ½ä¸ºé›¶

æœç´¢ç»“æœå·²å¯¼å‡ºåˆ°: D:\1fkl\exports\funckeeper_list_20241128_140324.html
```

### å¯¼å‡ºhtmlç¤ºä¾‹
![è¯¦æƒ…](assets/detail.png)
![åˆ—è¡¨](assets/list.png)
![ç»Ÿè®¡](assets/tj.png)

è¿™äº›ç¤ºä¾‹å±•ç¤ºäº† `funckeeper` çš„ä¸»è¦åŠŸèƒ½å’Œä½¿ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬å‡½æ•°è£…é¥°ã€é”™è¯¯å¤„ç†ã€ç»Ÿè®¡åˆ†æå’Œæ•°æ®å¯¼å‡ºç­‰ç‰¹æ€§ã€‚

## è®¸å¯è¯

`funckeeper` éµå¾ª MIT è®¸å¯è¯ã€‚è¯¦ç»†ä¿¡æ¯è¯·å‚é˜… LICENSE æ–‡ä»¶ã€‚